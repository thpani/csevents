include ../forms.jade

mixin usertable(model)
  table.table.table-condensed
    thead
      th User
      th Status
      th Remove
    tr(ng-repeat='user in '+model)
      td {{ user.name }}
      td âœ“ current member
      td
        a.trash
          span.glyphicon.glyphicon-trash
  block

h1 {{action}} event series
form.form-horizontal(name="form" ng-submit="submit()" ng-class="{submitted: form.$submitted}" novalidate)

  - required = 1
  +textinput('Name', 'event.name')

  - required = 0
  +textinput('Info', 'event.info')

  +formelement('Editors')
    +usertable('event.u_editors')
    a.btn.btn-xs.btn-default(ng-click="addUser()")
      span.glyphicon.glyphicon-plus
      |  Invite new editor
    .help-block Editors are allowed to add and remove events to this event series, and edit events associated with it.

  +formelement('Admins')
    +usertable('event.u_admins')
    a.btn.btn-xs.btn-default(ng-click="addUser()")
      span.glyphicon.glyphicon-plus
      |  Invite new admin
    .help-block Admins are allowed to change every aspect of this event series.

  +formelement('Public Address')
    a.label.label-default(target="_self" href="/api/calendars/{{ event.cal_pub_id }}") ICAL
    .help-block This is the address for your calendar. Everybody who knows the URL can access the calendar.

  .form-group
    .col-sm-offset-2.col-sm-10
      button.btn.btn-default(type="submit") {{action}} event

script(type="text/ng-template" id="EventSeriesUserModal.html")
  .modal-header
    h3.modal-title Invite a user
  .modal-body
    form.form-horizontal(name="form" ng-submit="ok()")
      +textinput('Email', 'invitation.email')
  .modal-footer
    button.btn.btn-primary(ng-click="ok()") OK
    button.btn.btn-primary(ng-click="cancel()") Cancel
